# OpenAPI Endpoints

The OpenAPI export module brings ddra mappings which generate different types of OpenAPI documents (formerly known as Swagger) for any access or service domain.

It also brings the `openapi/ui` endpoint, which nicely displays the content of such an OpenAPI document in a human friendly way and lets you execute the contained REST requests conveniently from within the UI.

## OpenAPI UI
The `openapi/ui` endpoint takes two path parameters and additional query parameters:

`<mode>/<domain>[?additional parameters]`

| Parameter | Description |
| --- | --- |
| mode | **mode** selects what kind of requests you would like to document: `entities` - CRUD requests on entity level, `properties` - CRUD requests on property level, `services` - tribefire service requests  |
| domain (access) | Determines the _service domain_  of the requests. For CRUD requests this is **always an access** and the CRUD operations on its data model will be documented. For service requests this might either be an access or another kind of service domain and its service model will be documented. |
|additional parameters | sets properties of the REST request behind the called ddra mapping. See [parameters](#parameters) |

An example request could be
`<tribefire-services-url>/openapi/ui/services/cortex?useCases=openapi:simple`.

As this request reflects the service requests of the cortex access it should be available on any tribefire installation. So you can try it out right away.

## OpenAPI document generating REST endpoints

To generate OpenAPI documents like the ones used by the UI endpoint there are three service requests with respective DDRA mappings

(like any DDRA mapping the mapped path is appended to `<tribefire-services-url>/api/v1`)

1. `/openapi/services?serviceDomain=<domainId>` to reflect DDRA requests of a service domain (usually an access)
2. `/openapi/entities?accessId=<accessId>` to reflect entity CRUD requests of an access
3. `/openapi/properties?accessId=<accessId>` to reflect property CRUD requests of an access

### Parameters
The following request parameters are supported and can be specified via query parameters:

| Parameter | Description |
| --- | --- |
| useCases | Metadata usecase to be included while creating the document. See [metadata](metadata.md) |
| tribefireServicesUrl | The server URL used in the OpenAPI document e.g. the base URL used by the UI when sending requests from it. |
| includeSessionId | Explicitly sets the session id of the calling user as default value to the `sessionId` parameters of all reflected requests. This of course only makes sense for very temporary documents and is mainly used to have the parameter included in CURL commands generated by the UI.  |
| reflectSubtypes | Reflects schema polymorphy. This inflates the generated document significantly and thus isn't included by default. |
| reflectSupertypes | Reflects which properties come from which supertype. This blows up the generated document significantly and thus isn't included by default. |
